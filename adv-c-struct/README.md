Some code from John W.L. Ogilvie's "Advanced C Struct Programming"
